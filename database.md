**飞瀑-在线灵感交流系统（数据库部分）**

# 目录

# 1.概述

 	在这个创新力匮乏的时代，人们疲于创造新事物而热衷于复制和改造旧者。这种风潮出现在艺术、科学、文学等多个领域，在中国，创新力缺乏的现状更甚。近些年分享开源的理念十分火爆，而新的好的想法有助于催生新的发明和产业的出现，因此我们想要提供一个可供人们分享和交流灵感和思维图的平台。正如萧伯纳所说：&quot;你有一个苹果，我有一个苹果，我们彼此交换，每人还是一个苹果；你有一种思想，我有一种思想，我们彼此交换，每人可拥有两种思想。&quot;



# 2.需求分析

## 2.1系统层面

- 用户管理

系统具有三类用户：超级管理员、管理员和瀑友，超级管理员在系统创建时生成，管理员由超级管理员创建，游客可以通过注册成为瀑友。

管理员分为三种：A类管理员可以对话题进行增加、修改、删除；B类管理员可以对瀑友进行修改、冻结（限制部分功能）和删除；C类管理员可以对帖子进行删除。

- 用户通过手机注册（快速注册）后，系统会给用户生成一个随机的用户名，在用户绑定邮箱后，可以通过邮箱/用户名/手机号登陆

- 瀑友可以修改自己的个人详细信息，关注话题和发帖

- 2.1.2 帖子管理

- 游客只能浏览帖子；
- 瀑友未关注对应话题可以点赞和收藏帖子，关注话题的可以进行回复帖子、点赞和发表新帖子，包括字音视频图以及各种附件(思维导图等)。瀑友可以管理修改自己的发帖，并拥有管理权（删除、修改、管理评论回复）；
- C类管理员有权对帖子就行删除；
- 帖子包含人气(浏览量）、点赞数和收藏数；
- 帖子分为主题贴，瀑友可以评论某个瀑友的主题帖，称为评论（对象是主题）也可以回复其他瀑友的消息（称为回复，的对象是主题下的评论），评论贴和回复贴只能包含文字消息
- 一个主题帖只能属于一种话题

- 2.1.3 话题管理

- 每个帖子只能属于一种话题，一个话题下有多个帖子

- 被冻结的瀑友不能发帖，但可以进行点赞和收藏（相当于未关注任何话题）
- 一个瀑友可以关注多个话题，一个话题可以被多个瀑友关注

# 4.逻辑结构设计

将上述概念结构设计中的实体联系图转化为如下关系模式：

- 瀑友（瀑友号，用户名，手机号，国家代码，密码，用户状态，性别，真实姓名，昵称，出生日期，电子邮箱，职业，头像，介绍，居住地，已关注话题，话题数，发帖数，点赞数，收藏数）
- 管理员（管理员号，用户名，昵称，密码，类型）
- 超级管理员（超级管理员号，用户名，昵称，密码）
- 帖子（帖子号，瀑友号，话题号，文字，图片，附件）
- 话题（话题号，名称，简介，简介图，关注数，帖子数）
- 关注（话题号，瀑友号）
- 评论（帖子号，瀑友号，评论内容）
- 回复（评论号，帖子号，目标瀑友号，回复内容）

# 5.数据库实施

> 此数据库的表均采用UTF-8编码格式_h

| 列名      | 名称     | 类型        | 主键 | 能否为空 | 约束 |
| --------- | -------- | ----------- | ---- | -------- | ---- |
| U\_id     | 编号     | int         | 是   | 否       | 自增 |
| U\_name   | 用户名   | Varchar(15) | 否   | 否       | 无   |
| U\_mobile | 手机号   | nchar(11)   | 否   | 否       | 无   |
| U\_pw     | 密码     | Varchar(20) | 否   | 否       | 无   |
| U\_status | 用户状态 | Varchar(20) | 否   | 否       | 无   |

表 5- 0  用户登录

| 列名          | 中文名   | 类型         | 主键 | 能否为空 | 约束 |
| ------------- | -------- | ------------ | ---- | -------- | ---- |
| U\_id         | 编号     | Int          | 是   | 否       | 外键 |
| U\_sex        | 性别     | nchar(3)     | 否   | 是       | 无   |
| U\_real\_name | 真实姓名 | Varchar(39)  | 否   | 是       | 无   |
| U\_email      | 电子邮件 | Varchar(320) | 否   | 是       | 无   |
| U\_nickname   | 昵称     | Varchar(24)  | 否   | 是       | 无   |
| U\_avatar     | 头像     | Varchar(255) | 否   | 是       | 无   |
| U\_intro      | 介绍     | text         | 否   | 是       | 无   |
| U\_city       | 居住地   | Varchar(15)  | 否   | 是       | 无   |
| U\_birth      | 出生日期 | Date         | 否   | 是       | 无   |
| U\_career     | 职业     | varchar(30)  | 否   | 是       | 无   |
| U\_topic\_num | 关注数   | Int          | 否   | 是       | 无   |
| U\_note\_num  | 发帖数   | Int          | 否   | 是       | 无   |

表 5- 1 用户信息

| 列名        | 名称   | 类型        | 主键 | 能否为空 | 约束 |
| ----------- | ------ | ----------- | ---- | -------- | ---- |
| A\_ id      | 编号   | Int         | 是   | 否       | 自增 |
| A\_name     | 用户名 | Varchar(15) | 否   | 否       | 无   |
| A\_pw       | 密码   | Varchar(20) | 否   | 否       | 无   |
| A\_nickname | 昵称   | Varchar(24) | 否   | 是       | 无   |
| A\_type     | 类型   | nchar(1)    | 否   | 否       | 无   |

表 5- 2 管理员

| 列名         | 名称   | 类型        | 主键 | 能否为空 | 约束 |
| ------------ | ------ | ----------- | ---- | -------- | ---- |
| SA\_ id      | 编号   | int         | 是   | 否       | 无   |
| SA\_name     | 用户名 | Varchar(15) | 否   | 否       | 无   |
| SA\_pw       | 密码   | Varchar(20) | 是   | 否       | 无   |
| SA\_nickname | 昵称   | Varchar(24) | 是   | 否       | 无   |

表 5- 3 超级管理员

| 列名         | 名称     | 类型         | 主键 | 能否为空 | 约束 |
| ------------ | -------- | ------------ | ---- | -------- | ---- |
| N\_ id       | 编号     | Int          | 是   | 否       | 自增 |
| U\_ id       | 瀑友号   | int          | 是   | 否       | 外键 |
| T\_ id       | 话题号   | int          | 是   | 否       | 外键 |
| N\_title     | 标题     | Varchar(90)  | 否   | 否       | 无   |
| N\_text\_loc | 正文     | text         | 否   | 是       | 无   |
| N\_img\_loc  | 图片     | Varchar(255) | 否   | 是       | 无   |
| N_attach_loc | 附件     | varchar(255) | 否   | 是       | 无   |
| N_add_time   | 发表时间 | datetime     | 否   | 否       | 无   |

表 5- 4 帖子

| 列名             | 名称   | 类型         | 主键 | 能否为空 | 约束 |
| ---------------- | ------ | ------------ | ---- | -------- | ---- |
| T\_ id           | 编号   | Int          | 是   | 否       | 自增 |
| T\_name          | 名称   | Varchar(30)  | 否   | 否       | 无   |
| T\_intro         | 简介   | text         | 否   | 是       | 无   |
| T\_introImg\_loc | 简介图 | Varchar(255) | 否   | 否       | 无   |
| T\_follow\_num   | 关注数 | Int          | 否   | 是       | 无   |
| T\_note\_num     | 帖子数 | Int          | 否   | 是       | 无   |

表 5- 5 话题

| 列名   | 名称   | 类型 | 主键 | 能否为空 | 约束 |
| ------ | ------ | ---- | ---- | -------- | ---- |
| T\_ id | 话题号 | int  | 是   | 否       | 外键 |
| U\_ id | 瀑友号 | int  | 是   | 否       | 外键 |

表 5- 6 关注

| 列名       | 名称     | 类型     | 主键 | 能否为空 | 约束 |
| ---------- | -------- | -------- | ---- | -------- | ---- |
| C\_ id     | 编号     | Int      | 是   | 否       | 无   |
| U\_ id     | 瀑友号   | Int      | 是   | 否       | 外键 |
| C\_text    | 评论内容 | text     | 否   | 否       | 无   |
| C_add_time | 发布时间 | datetime | 否   | 否       | 无   |

表 5- 7 评论

| 列名       | 名称     | 类型     | 主键 | 能否为空 | 约束 |
| ---------- | -------- | -------- | ---- | -------- | ---- |
| R\_id      | 评论编号 | Int      | 是   | 否       | 无   |
| N\_id      | 帖子编号 | Int      | 是   | 否       | 外键 |
| U\_id      | 瀑友号   | Int      | 是   | 否       | 无   |
| R\_text    | 评论内容 | text     | 否   | 否       | 无   |
| R_add_time | 发布时间 | datetime | 否   | 否       | 无   |

表 5- 8 回复



